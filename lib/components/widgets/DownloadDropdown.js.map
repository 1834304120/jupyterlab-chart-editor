{"version":3,"sources":["../../../src/components/widgets/DownloadDropdown.js"],"names":["DownloadDropdown","allowedExportTypes","graphURLBase","downloadItemClass","map","format","index","url","formatUpper","toUpperCase","restrictedExportTypes","downloadItemClassMuted","props","currentUser","shareKey","feature_set","feature_set_id","fullFeatureSet","allExportTypes","file_export_types","value","filter","includes","exportType","containerClass","renderAllowedExportTypes","renderRestrictedExportTypes","exportUrl","propTypes","string","isRequired","ext","base","module","exports"],"mappings":"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","file":"DownloadDropdown.js","sourcesContent":["import React, {Component, PropTypes} from 'react';\nimport classnames from 'classnames';\nimport getFeatureValue, {getFeatureSetByID} from '@common/utils/features';\nimport {currentUserOrNull} from '@workspace/utils/customPropTypes';\n\nclass DownloadDropdown extends Component {\n    renderAllowedExportTypes(allowedExportTypes = [], graphURLBase) {\n        const downloadItemClass = classnames(\n            'dropdown-menu-item', '--product-pages', '--brand-blue-hover'\n        );\n\n        return allowedExportTypes.map((format, index) => {\n            const url = `${graphURLBase}.${format}`;\n            const formatUpper = format.toUpperCase();\n            return (\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={url}\n                   key={index}\n                >\n                    {formatUpper}\n                </a>\n            );\n        });\n    }\n\n    renderRestrictedExportTypes(restrictedExportTypes = []) {\n        const downloadItemClassMuted = 'dropdown-menu-item-restricted';\n\n        return restrictedExportTypes.map((format, index) => {\n            const formatUpper = format.toUpperCase();\n            return (\n                <a target=\"_blank\"\n                   className={downloadItemClassMuted}\n                   key={index}\n                >\n                    {formatUpper}\n                </a>\n            );\n        });\n    }\n\n    render() {\n        const {graphURLBase, currentUser, shareKey} = this.props;\n        const feature_set = currentUser ? currentUser.feature_set_id : null;\n        let restrictedExportTypes;\n\n        const fullFeatureSet = getFeatureSetByID('full');\n        const allExportTypes = fullFeatureSet.file_export_types.value;\n\n        const allowedExportTypes = getFeatureValue(\n            feature_set, 'file_export_types'\n        );\n\n        if (allExportTypes && allowedExportTypes) {\n            restrictedExportTypes = allExportTypes.filter(exportType => (\n                !allowedExportTypes.includes(exportType)\n            ));\n        }\n\n        const downloadItemClass = classnames(\n            'dropdown-menu-item', '--product-pages', '--brand-blue-hover'\n        );\n\n        const containerClass = classnames('dropdown-menu',\n                                          '--feed-download-menu',\n                                          '--product-pages',\n                                          '--atright');\n\n        return (\n            <div className={containerClass}>\n                <div className=\"dropdown-menu-triangle --grey-menu-triangle +no-right\"></div>\n\n                <span className=\"dropdown-menu-title\">Download Image</span>\n                {this.renderAllowedExportTypes(allowedExportTypes, graphURLBase)}\n                {this.renderRestrictedExportTypes(restrictedExportTypes)}\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('embed', graphURLBase, shareKey)}\n                >\n                    {'Full-screen'}\n                </a>\n\n                <span className=\"dropdown-menu-title\">Download Data</span>\n\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('csv', graphURLBase, shareKey)}\n                >\n                    {'CSV'}\n                </a>\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('xlsx', graphURLBase, shareKey)}\n                >\n                    {'Excel (xlsx)'}\n                </a>\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href=\"https://store.office.com/plotly-charts-WA104379485.aspx?assetid=WA104379485\"\n                >\n                    {'PowerPoint'}\n                </a>\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('json', graphURLBase, shareKey)}\n                >\n                    {'JSON'}\n                </a>\n\n                <span className=\"dropdown-menu-title\">Download Code</span>\n\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('py', graphURLBase, shareKey)}\n                >\n                    {'Python'}\n                </a>\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('m', graphURLBase, shareKey)}\n                >\n                    {'MATLAB'}\n                </a>\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('r', graphURLBase, shareKey)}\n                >\n                    {'R'}\n                </a>\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('js', graphURLBase, shareKey)}\n                >\n                    {'plotly.js'}\n                </a>\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('nodejs', graphURLBase, shareKey)}\n                >\n                    {'node.js'}\n                </a>\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('jl', graphURLBase, shareKey)}\n                >\n                    {'Julia'}\n                </a>\n\n                <span className=\"dropdown-menu-title\">Download HTML</span>\n\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('zip', graphURLBase, shareKey)}\n                >\n                    {'Zip archive'}\n                </a>\n\n                <a target=\"_blank\"\n                   className={downloadItemClass}\n                   href={exportUrl('download', graphURLBase, shareKey)}\n                >\n                    {'HTML'}\n                </a>\n            </div>\n        );\n    }\n}\n\nDownloadDropdown.propTypes = {\n    graphURLBase: PropTypes.string.isRequired,\n    currentUser: currentUserOrNull,\n    shareKey: PropTypes.string\n};\n\nfunction exportUrl(ext, base, shareKey) {\n    let url = `${base}.${ext}`;\n\n    if (shareKey) {\n        url += `?share_key=${shareKey}`;\n    }\n\n    return url;\n}\n\nmodule.exports = DownloadDropdown;\n"]}