{"version":3,"sources":["../../../src/components/widgets/DownloadDropdown.js"],"names":["DownloadDropdown","allowedExportTypes","graphURLBase","downloadItemClass","map","format","index","url","formatUpper","toUpperCase","restrictedExportTypes","downloadItemClassMuted","props","currentUser","shareKey","feature_set","feature_set_id","fullFeatureSet","allExportTypes","file_export_types","value","filter","includes","exportType","containerClass","renderAllowedExportTypes","renderRestrictedExportTypes","exportUrl","propTypes","string","isRequired","ext","base","module","exports"],"mappings":";;;;AAAA;;;;AACA;;;;AACA;;;;AACA;;;;AACA;;;;;;;;;;IAEMA,gB;;;;;;;;;;;+CAC4D;AAAA,UAAvCC,kBAAuC,uEAAlB,EAAkB;AAAA,UAAdC,YAAc;;AAC9D,UAAMC,oBAAoB,0BACxB,oBADwB,EAExB,iBAFwB,EAGxB,oBAHwB,CAA1B;;AAMA,aAAOF,mBAAmBG,GAAnB,CAAuB,UAACC,MAAD,EAASC,KAAT,EAAmB;AAC/C,YAAMC,MAASL,YAAT,SAAyBG,MAA/B;AACA,YAAMG,cAAcH,OAAOI,WAAP,EAApB;AACA,eACE;AAAA;AAAA,YAAG,QAAO,QAAV,EAAmB,WAAWN,iBAA9B,EAAiD,MAAMI,GAAvD,EAA4D,KAAKD,KAAjE;AACGE;AADH,SADF;AAKD,OARM,CAAP;AASD;;;kDAEuD;AAAA,UAA5BE,qBAA4B,uEAAJ,EAAI;;AACtD,UAAMC,yBAAyB,+BAA/B;;AAEA,aAAOD,sBAAsBN,GAAtB,CAA0B,UAACC,MAAD,EAASC,KAAT,EAAmB;AAClD,YAAME,cAAcH,OAAOI,WAAP,EAApB;AACA,eACE;AAAA;AAAA,YAAG,QAAO,QAAV,EAAmB,WAAWE,sBAA9B,EAAsD,KAAKL,KAA3D;AACGE;AADH,SADF;AAKD,OAPM,CAAP;AAQD;;;6BAEQ;AAAA,mBACyC,KAAKI,KAD9C;AAAA,UACCV,YADD,UACCA,YADD;AAAA,UACeW,WADf,UACeA,WADf;AAAA,UAC4BC,QAD5B,UAC4BA,QAD5B;;AAEP,UAAMC,cAAcF,cAAcA,YAAYG,cAA1B,GAA2C,IAA/D;AACA,UAAIN,8BAAJ;;AAEA,UAAMO,iBAAiB,iCAAkB,MAAlB,CAAvB;AACA,UAAMC,iBAAiBD,eAAeE,iBAAf,CAAiCC,KAAxD;;AAEA,UAAMnB,qBAAqB,wBACzBc,WADyB,EAEzB,mBAFyB,CAA3B;;AAKA,UAAIG,kBAAkBjB,kBAAtB,EAA0C;AACxCS,gCAAwBQ,eAAeG,MAAf,CACtB;AAAA,iBAAc,CAACpB,mBAAmBqB,QAAnB,CAA4BC,UAA5B,CAAf;AAAA,SADsB,CAAxB;AAGD;;AAED,UAAMpB,oBAAoB,0BACxB,oBADwB,EAExB,iBAFwB,EAGxB,oBAHwB,CAA1B;;AAMA,UAAMqB,iBAAiB,0BACrB,eADqB,EAErB,sBAFqB,EAGrB,iBAHqB,EAIrB,WAJqB,CAAvB;;AAOA,aACE;AAAA;AAAA,UAAK,WAAWA,cAAhB;AACE,+CAAK,WAAU,uDAAf,GADF;AAGE;AAAA;AAAA,YAAM,WAAU,qBAAhB;AAAA;AAAA,SAHF;AAIG,aAAKC,wBAAL,CAA8BxB,kBAA9B,EAAkDC,YAAlD,CAJH;AAKG,aAAKwB,2BAAL,CAAiChB,qBAAjC,CALH;AAME;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWP,iBAFb;AAGE,kBAAMwB,UAAU,OAAV,EAAmBzB,YAAnB,EAAiCY,QAAjC;AAHR;AAKG;AALH,SANF;AAcE;AAAA;AAAA,YAAM,WAAU,qBAAhB;AAAA;AAAA,SAdF;AAgBE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,KAAV,EAAiBzB,YAAjB,EAA+BY,QAA/B;AAHR;AAKG;AALH,SAhBF;AAuBE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,MAAV,EAAkBzB,YAAlB,EAAgCY,QAAhC;AAHR;AAKG;AALH,SAvBF;AA8BE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAK;AAHP;AAKG;AALH,SA9BF;AAqCE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWA,iBAFb;AAGE,kBAAMwB,UAAU,MAAV,EAAkBzB,YAAlB,EAAgCY,QAAhC;AAHR;AAKG;AALH,SArCF;AA6CE;AAAA;AAAA,YAAM,WAAU,qBAAhB;AAAA;AAAA,SA7CF;AA+CE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,IAAV,EAAgBzB,YAAhB,EAA8BY,QAA9B;AAHR;AAKG;AALH,SA/CF;AAsDE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,GAAV,EAAezB,YAAf,EAA6BY,QAA7B;AAHR;AAKG;AALH,SAtDF;AA6DE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,GAAV,EAAezB,YAAf,EAA6BY,QAA7B;AAHR;AAKG;AALH,SA7DF;AAoEE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,IAAV,EAAgBzB,YAAhB,EAA8BY,QAA9B;AAHR;AAKG;AALH,SApEF;AA2EE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,QAAV,EAAoBzB,YAApB,EAAkCY,QAAlC;AAHR;AAKG;AALH,SA3EF;AAkFE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,IAAV,EAAgBzB,YAAhB,EAA8BY,QAA9B;AAHR;AAKG;AALH,SAlFF;AA0FE;AAAA;AAAA,YAAM,WAAU,qBAAhB;AAAA;AAAA,SA1FF;AA4FE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,KAAV,EAAiBzB,YAAjB,EAA+BY,QAA/B;AAHR;AAKG;AALH,SA5FF;AAoGE;AAAA;AAAA;AACE,oBAAO,QADT;AAEE,uBAAWX,iBAFb;AAGE,kBAAMwB,UAAU,UAAV,EAAsBzB,YAAtB,EAAoCY,QAApC;AAHR;AAKG;AALH;AApGF,OADF;AA8GD;;;;;;AAGHd,iBAAiB4B,SAAjB,GAA6B;AAC3B1B,gBAAc,oBAAU2B,MAAV,CAAiBC,UADJ;AAE3BjB,iDAF2B;AAG3BC,YAAU,oBAAUe;AAHO,CAA7B;;AAMA,SAASF,SAAT,CAAmBI,GAAnB,EAAwBC,IAAxB,EAA8BlB,QAA9B,EAAwC;AACtC,MAAIP,MAASyB,IAAT,SAAiBD,GAArB;;AAEA,MAAIjB,QAAJ,EAAc;AACZP,2BAAqBO,QAArB;AACD;;AAED,SAAOP,GAAP;AACD;;AAED0B,OAAOC,OAAP,GAAiBlC,gBAAjB","file":"DownloadDropdown.js","sourcesContent":["import React, { Component } from \"react\";\nimport PropTypes from \"prop-types\";\nimport classnames from \"classnames\";\nimport getFeatureValue, { getFeatureSetByID } from \"@common/utils/features\";\nimport { currentUserOrNull } from \"@workspace/utils/customPropTypes\";\n\nclass DownloadDropdown extends Component {\n  renderAllowedExportTypes(allowedExportTypes = [], graphURLBase) {\n    const downloadItemClass = classnames(\n      \"dropdown-menu-item\",\n      \"--product-pages\",\n      \"--brand-blue-hover\"\n    );\n\n    return allowedExportTypes.map((format, index) => {\n      const url = `${graphURLBase}.${format}`;\n      const formatUpper = format.toUpperCase();\n      return (\n        <a target=\"_blank\" className={downloadItemClass} href={url} key={index}>\n          {formatUpper}\n        </a>\n      );\n    });\n  }\n\n  renderRestrictedExportTypes(restrictedExportTypes = []) {\n    const downloadItemClassMuted = \"dropdown-menu-item-restricted\";\n\n    return restrictedExportTypes.map((format, index) => {\n      const formatUpper = format.toUpperCase();\n      return (\n        <a target=\"_blank\" className={downloadItemClassMuted} key={index}>\n          {formatUpper}\n        </a>\n      );\n    });\n  }\n\n  render() {\n    const { graphURLBase, currentUser, shareKey } = this.props;\n    const feature_set = currentUser ? currentUser.feature_set_id : null;\n    let restrictedExportTypes;\n\n    const fullFeatureSet = getFeatureSetByID(\"full\");\n    const allExportTypes = fullFeatureSet.file_export_types.value;\n\n    const allowedExportTypes = getFeatureValue(\n      feature_set,\n      \"file_export_types\"\n    );\n\n    if (allExportTypes && allowedExportTypes) {\n      restrictedExportTypes = allExportTypes.filter(\n        exportType => !allowedExportTypes.includes(exportType)\n      );\n    }\n\n    const downloadItemClass = classnames(\n      \"dropdown-menu-item\",\n      \"--product-pages\",\n      \"--brand-blue-hover\"\n    );\n\n    const containerClass = classnames(\n      \"dropdown-menu\",\n      \"--feed-download-menu\",\n      \"--product-pages\",\n      \"--atright\"\n    );\n\n    return (\n      <div className={containerClass}>\n        <div className=\"dropdown-menu-triangle --grey-menu-triangle +no-right\" />\n\n        <span className=\"dropdown-menu-title\">Download Image</span>\n        {this.renderAllowedExportTypes(allowedExportTypes, graphURLBase)}\n        {this.renderRestrictedExportTypes(restrictedExportTypes)}\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"embed\", graphURLBase, shareKey)}\n        >\n          {\"Full-screen\"}\n        </a>\n\n        <span className=\"dropdown-menu-title\">Download Data</span>\n\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"csv\", graphURLBase, shareKey)}\n        >\n          {\"CSV\"}\n        </a>\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"xlsx\", graphURLBase, shareKey)}\n        >\n          {\"Excel (xlsx)\"}\n        </a>\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href=\"https://store.office.com/plotly-charts-WA104379485.aspx?assetid=WA104379485\"\n        >\n          {\"PowerPoint\"}\n        </a>\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"json\", graphURLBase, shareKey)}\n        >\n          {\"JSON\"}\n        </a>\n\n        <span className=\"dropdown-menu-title\">Download Code</span>\n\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"py\", graphURLBase, shareKey)}\n        >\n          {\"Python\"}\n        </a>\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"m\", graphURLBase, shareKey)}\n        >\n          {\"MATLAB\"}\n        </a>\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"r\", graphURLBase, shareKey)}\n        >\n          {\"R\"}\n        </a>\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"js\", graphURLBase, shareKey)}\n        >\n          {\"plotly.js\"}\n        </a>\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"nodejs\", graphURLBase, shareKey)}\n        >\n          {\"node.js\"}\n        </a>\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"jl\", graphURLBase, shareKey)}\n        >\n          {\"Julia\"}\n        </a>\n\n        <span className=\"dropdown-menu-title\">Download HTML</span>\n\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"zip\", graphURLBase, shareKey)}\n        >\n          {\"Zip archive\"}\n        </a>\n\n        <a\n          target=\"_blank\"\n          className={downloadItemClass}\n          href={exportUrl(\"download\", graphURLBase, shareKey)}\n        >\n          {\"HTML\"}\n        </a>\n      </div>\n    );\n  }\n}\n\nDownloadDropdown.propTypes = {\n  graphURLBase: PropTypes.string.isRequired,\n  currentUser: currentUserOrNull,\n  shareKey: PropTypes.string,\n};\n\nfunction exportUrl(ext, base, shareKey) {\n  let url = `${base}.${ext}`;\n\n  if (shareKey) {\n    url += `?share_key=${shareKey}`;\n  }\n\n  return url;\n}\n\nmodule.exports = DownloadDropdown;\n"]}